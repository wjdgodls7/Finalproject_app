{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/taggedTemplateLiteralLoose\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\GG\\\\Documents\\\\finalproject\\\\semicolon-app\\\\screens\\\\photo\\\\UploadProfile.js\";\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteralLoose([\"\\n    mutation editUser(\\n        $avatar:String\\n    )\\n    {editUser(\\n    avatar : $avatar\\n    )\\n  }\"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  color: white;\\n  font-weight: 600;\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background-color: \", \";\\n  width: 40%;\\n  margin : auto\\n  marginTop:30px;\\n   padding: 10px;\\n  border-radius: 4px;\\n  align-items: center;\\n  justify-content: center;\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  justify-content: flex-start;\\n  display: flex;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  padding: 20px;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  flex: 1;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from \"react\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport styled from \"styled-components/native\";\nimport axios from \"axios\";\nimport { gql } from \"apollo-boost\";\nimport { useMutation } from \"react-apollo-hooks\";\nimport { FEED_QUERY } from \"../home/Home\";\nimport { ME } from \"../tabs/Profile\";\nvar View = styled.View(_templateObject());\nvar Container = styled.View(_templateObject2());\nvar Form = styled.View(_templateObject3());\nvar Button = styled.TouchableOpacity(_templateObject4(), function (props) {\n  return props.theme.navyColor;\n});\nvar Text = styled.Text(_templateObject5());\nvar EDIT_USER = gql(_templateObject6());\nexport default (function (_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var photo = navigation.getParam(\"photo\");\n\n  var _useMutation = useMutation(EDIT_USER),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      editUserMutation = _useMutation2[0];\n\n  var handleSubmit = function handleSubmit() {\n    var formData, name, _name$split, _name$split2, type, imageType, _await$axios$post, location, _await$editUserMutati, editUser;\n\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            formData = new FormData();\n            name = photo.filename;\n            _name$split = name.split(\".\"), _name$split2 = _slicedToArray(_name$split, 2), type = _name$split2[1];\n            imageType = Platform.os === \"ios\" ? type.toLowerCase() : \"image/jpeg\";\n            formData.append(\"file\", {\n              name: name,\n              type: imageType,\n              uri: photo.uri\n            });\n            _context.prev = 5;\n            setIsLoading(true);\n            _context.next = 9;\n            return _regeneratorRuntime.awrap(axios.post(\"https://teamsemicolon-backend.herokuapp.com/api/upload\", formData, {\n              headers: {\n                \"content-type\": \"multipart/form-data\"\n              }\n            }));\n\n          case 9:\n            _await$axios$post = _context.sent;\n            location = _await$axios$post.data.location;\n            _context.next = 13;\n            return _regeneratorRuntime.awrap(editUserMutation({\n              variables: {\n                avatar: location\n              },\n              refetchQueries: [{\n                query: ME,\n                query: FEED_QUERY\n              }]\n            }));\n\n          case 13:\n            _await$editUserMutati = _context.sent;\n            editUser = _await$editUserMutati.data;\n\n            if (editUser) {\n              navigation.navigate(\"Profile\");\n            }\n\n            _context.next = 22;\n            break;\n\n          case 18:\n            _context.prev = 18;\n            _context.t0 = _context[\"catch\"](5);\n            console.log(_context.t0);\n            Alert.alert(\"Cant Submit\", \"Try later\");\n\n          case 22:\n            _context.prev = 22;\n            setIsLoading(false);\n            return _context.finish(22);\n\n          case 25:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[5, 18, 22, 25]], Promise);\n  };\n\n  return React.createElement(View, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 5\n    }\n  }, React.createElement(Container, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, React.createElement(Image, {\n    source: {\n      uri: photo.uri\n    },\n    style: {\n      height: 80,\n      width: 80,\n      marginLeft: 120,\n      borderRadius: 40\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }), React.createElement(Form, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }\n  }, React.createElement(Button, {\n    onPress: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 11\n    }\n  }, loading ? React.createElement(ActivityIndicator, {\n    color: \"white\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 15\n    }\n  }) : React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }, \"Submit \")))));\n});","map":{"version":3,"sources":["C:/Users/GG/Documents/finalproject/semicolon-app/screens/photo/UploadProfile.js"],"names":["React","useState","styled","axios","gql","useMutation","FEED_QUERY","ME","View","Container","Form","Button","TouchableOpacity","props","theme","navyColor","Text","EDIT_USER","navigation","loading","setIsLoading","photo","getParam","editUserMutation","handleSubmit","formData","FormData","name","filename","split","type","imageType","Platform","os","toLowerCase","append","uri","post","headers","location","data","variables","avatar","refetchQueries","query","editUser","navigate","console","log","Alert","alert","height","width","marginLeft","borderRadius"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;;;;;AAEA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,GAAT,QAAoB,cAApB;AACA,SAASC,WAAT,QAA4B,oBAA5B;AACA,SAASC,UAAT;AACA,SAASC,EAAT;AAGA,IAAMC,IAAI,GAAGN,MAAM,CAACM,IAAV,mBAAV;AAIA,IAAMC,SAAS,GAAGP,MAAM,CAACM,IAAV,oBAAf;AAIA,IAAME,IAAI,GAAGR,MAAM,CAACM,IAAV,oBAAV;AAKA,IAAMG,MAAM,GAAGT,MAAM,CAACU,gBAAV,qBACU,UAAAC,KAAK;AAAA,SAAIA,KAAK,CAACC,KAAN,CAAYC,SAAhB;AAAA,CADf,CAAZ;AAWA,IAAMC,IAAI,GAAGd,MAAM,CAACc,IAAV,oBAAV;AAIA,IAAMC,SAAS,GAAGb,GAAH,oBAAf;AAQA,gBAAe,gBAAoB;AAAA,MAAjBc,UAAiB,QAAjBA,UAAiB;;AAAA,kBACDjB,QAAQ,CAAC,KAAD,CADP;AAAA;AAAA,MAC1BkB,OAD0B;AAAA,MACjBC,YADiB;;AAEjC,MAAMC,KAAK,GAAGH,UAAU,CAACI,QAAX,CAAoB,OAApB,CAAd;;AAFiC,qBAGNjB,WAAW,CAACY,SAAD,CAHL;AAAA;AAAA,MAG1BM,gBAH0B;;AAKjC,MAAMC,YAAY,GAAG,SAAfA,YAAe;AAAA;;AAAA;AAAA;AAAA;AAAA;AAEbC,YAAAA,QAFa,GAEF,IAAIC,QAAJ,EAFE;AAGXC,YAAAA,IAHW,GAGJN,KAAK,CAACO,QAHF;AAAA,0BAIAD,IAAI,CAACE,KAAL,CAAW,GAAX,CAJA,iDAIRC,IAJQ;AAKbC,YAAAA,SALa,GAKDC,QAAQ,CAACC,EAAT,KAAgB,KAAhB,GAAwBH,IAAI,CAACI,WAAL,EAAxB,GAA6C,YAL5C;AAMnBT,YAAAA,QAAQ,CAACU,MAAT,CAAgB,MAAhB,EAAwB;AACtBR,cAAAA,IAAI,EAAJA,IADsB;AAEtBG,cAAAA,IAAI,EAAEC,SAFgB;AAGtBK,cAAAA,GAAG,EAAEf,KAAK,CAACe;AAHW,aAAxB;AANmB;AAYjBhB,YAAAA,YAAY,CAAC,IAAD,CAAZ;AAZiB;AAAA,6CAePjB,KAAK,CAACkC,IAAN,CAAW,wDAAX,EAAqEZ,QAArE,EAA+E;AACvFa,cAAAA,OAAO,EAAE;AACP,gCAAgB;AADT;AAD8E,aAA/E,CAfO;;AAAA;AAAA;AAcPC,YAAAA,QAdO,qBAcfC,IAde,CAcPD,QAdO;AAAA;AAAA,6CAoBgBhB,gBAAgB,CAC/C;AACEkB,cAAAA,SAAS,EAAE;AAAEC,gBAAAA,MAAM,EAAEH;AAAV,eADb;AAEEI,cAAAA,cAAc,EAAE,CAAC;AAAEC,gBAAAA,KAAK,EAAErC,EAAT;AAAaqC,gBAAAA,KAAK,EAAEtC;AAApB,eAAD;AAFlB,aAD+C,CApBhC;;AAAA;AAAA;AAoBHuC,YAAAA,QApBG,yBAoBTL,IApBS;;AA0BjB,gBAAIK,QAAJ,EAAc;AACZ3B,cAAAA,UAAU,CAAC4B,QAAX,CAAoB,SAApB;AACD;;AA5BgB;AAAA;;AAAA;AAAA;AAAA;AA8BjBC,YAAAA,OAAO,CAACC,GAAR;AACAC,YAAAA,KAAK,CAACC,KAAN,CAAY,aAAZ,EAA2B,WAA3B;;AA/BiB;AAAA;AAiCjB9B,YAAAA,YAAY,CAAC,KAAD,CAAZ;AAjCiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAArB;;AAwCA,SACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,KAAD;AACE,IAAA,MAAM,EAAE;AAAEgB,MAAAA,GAAG,EAAEf,KAAK,CAACe;AAAb,KADV;AAEE,IAAA,KAAK,EAAE;AAAEe,MAAAA,MAAM,EAAE,EAAV;AAAcC,MAAAA,KAAK,EAAE,EAArB;AAAyBC,MAAAA,UAAU,EAAE,GAArC;AAA0CC,MAAAA,YAAY,EAAE;AAAxD,KAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAKE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAE9B,YAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGL,OAAO,GACN,oBAAC,iBAAD;AAAmB,IAAA,KAAK,EAAC,OAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADM,GAGJ,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAJN,CADF,CALF,CADF,CADF;AAmBD,CAhED","sourcesContent":["import React, { useState } from \"react\";\r\nimport { Image, ActivityIndicator, Alert,Platform } from \"react-native\";\r\nimport styled from \"styled-components/native\";\r\nimport axios from \"axios\";\r\nimport { gql } from \"apollo-boost\";\r\nimport { useMutation } from \"react-apollo-hooks\";\r\nimport { FEED_QUERY } from \"../home/Home\";\r\nimport { ME } from \"../tabs/Profile\";\r\n\r\n\r\nconst View = styled.View`\r\n  flex: 1;\r\n`;\r\n\r\nconst Container = styled.View`\r\n  padding: 20px;\r\n`;\r\n\r\nconst Form = styled.View`\r\n  justify-content: flex-start;\r\n  display: flex;\r\n`;\r\n\r\nconst Button = styled.TouchableOpacity`\r\n  background-color: ${props => props.theme.navyColor};\r\n  width: 40%;\r\n  margin : auto\r\n  marginTop:30px;\r\n   padding: 10px;\r\n  border-radius: 4px;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst Text = styled.Text`\r\n  color: white;\r\n  font-weight: 600;\r\n`;\r\nconst EDIT_USER = gql`\r\n    mutation editUser(\r\n        $avatar:String\r\n    )\r\n    {editUser(\r\n    avatar : $avatar\r\n    )\r\n  }`\r\nexport default ({ navigation }) => {\r\n  const [loading, setIsLoading] = useState(false);\r\n  const photo = navigation.getParam(\"photo\")\r\n  const [editUserMutation] = useMutation(EDIT_USER);\r\n\r\n  const handleSubmit = async () => {\r\n\r\n    const formData = new FormData();\r\n      const name = photo.filename;\r\n      const [, type] = name.split(\".\");\r\n    const imageType = Platform.os === \"ios\" ? type.toLowerCase() : \"image/jpeg\";\r\n    formData.append(\"file\", {\r\n      name,\r\n      type: imageType,\r\n      uri: photo.uri\r\n    });\r\n    try {\r\n      setIsLoading(true)\r\n      const {\r\n        data: { location }\r\n      } = await axios.post(\"https://teamsemicolon-backend.herokuapp.com/api/upload\", formData, {\r\n        headers: {\r\n          \"content-type\": \"multipart/form-data\"\r\n        }\r\n      });\r\n      const { data: editUser } = await editUserMutation(\r\n        {\r\n          variables: { avatar: location },\r\n          refetchQueries: [{ query: ME, query: FEED_QUERY }]\r\n        })\r\n\r\n      if (editUser) {\r\n        navigation.navigate(\"Profile\")\r\n      }\r\n    } catch (e) {\r\n      console.log(e)\r\n      Alert.alert(\"Cant Submit\", \"Try later\");\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <View>\r\n      <Container>\r\n        <Image\r\n          source={{ uri: photo.uri }}\r\n          style={{ height: 80, width: 80, marginLeft: 120, borderRadius: 40 }}\r\n        />\r\n        <Form>\r\n          <Button onPress={handleSubmit}>\r\n            {loading ? (\r\n              <ActivityIndicator color=\"white\" />\r\n            ) : (\r\n                <Text>Submit </Text>\r\n              )}\r\n          </Button>\r\n        </Form>\r\n      </Container>\r\n    </View>\r\n  );\r\n};"]},"metadata":{},"sourceType":"module"}