{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _taggedTemplateLiteralLoose from \"@babel/runtime/helpers/taggedTemplateLiteralLoose\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\GG\\\\Documents\\\\finalproject\\\\semicolon-app\\\\screens\\\\auth\\\\CheckEmail.js\";\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  margin-top: 25px;\\n  padding-top: 25px;\\n  border-top-width: 1px;\\n  border-color: \", \";\\n  border-style: solid;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteralLoose([\"\\nmargin-top: 20px;\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  justify-content: center;\\n  align-items: center;\\n  flex: 1;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from \"react\";\nimport styled from \"styled-components/native\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport AuthButton from \"../../components/AuthButton\";\nimport AuthInput from \"../../components/AuthInput\";\nimport useInput from \"../../hooks/useInput\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { useMutation } from 'react-apollo-hooks';\nimport { LOG_IN } from \"./AuthQueries\";\nimport * as Facebook from 'expo-facebook';\nimport * as Google from 'expo-google-app-auth';\nvar View = styled.View(_templateObject());\nvar GGContainer = styled.View(_templateObject2());\nvar FBContainer = styled.View(_templateObject3(), function (props) {\n  return props.theme.lightGreyColor;\n});\nexport default (function (_ref) {\n  var navigation = _ref.navigation;\n  var emailInput = useInput(navigation.getParam(\"email\", \"\"));\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useMutation = useMutation(LOG_IN, {\n    variables: {\n      email: emailInput.value\n    }\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      requestSecretMutation = _useMutation2[0];\n\n  var handleLogin = function handleLogin() {\n    var value, emailRegex, _await$requestSecretM, requestSecret;\n\n    return _regeneratorRuntime.async(function handleLogin$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            value = emailInput.value;\n            emailRegex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n            if (!(value === \"\")) {\n              _context.next = 6;\n              break;\n            }\n\n            return _context.abrupt(\"return\", Alert.alert(\"ì´ë©”ì¼ì„ ìž…ë ¥í•´ ì£¼ì„¸ìš”!\"));\n\n          case 6:\n            if (emailRegex.test(value)) {\n              _context.next = 8;\n              break;\n            }\n\n            return _context.abrupt(\"return\", Alert.alert(\"ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹ˆì—ìš”!\"));\n\n          case 8:\n            _context.prev = 8;\n            setLoading(true);\n            _context.next = 12;\n            return _regeneratorRuntime.awrap(requestSecretMutation());\n\n          case 12:\n            _await$requestSecretM = _context.sent;\n            requestSecret = _await$requestSecretM.data.requestSecret;\n            console.log(requestSecret);\n\n            if (!requestSecret) {\n              _context.next = 21;\n              break;\n            }\n\n            Alert.alert(\"ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”\");\n            navigation.navigate(\"Confirm\", {\n              email: value\n            });\n            return _context.abrupt(\"return\");\n\n          case 21:\n            Alert.alert(\"ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”\");\n\n          case 22:\n            _context.next = 28;\n            break;\n\n          case 24:\n            _context.prev = 24;\n            _context.t0 = _context[\"catch\"](8);\n            console.log(_context.t0);\n            Alert.alert(\"ë¡œê·¸ì¸ ì‹¤íŒ¨\", \"ì§€ê¸ˆì€ ë¡œê·¸ì¸í• ìˆ˜ ì—†ì–´ìš” ðŸ˜¥\");\n\n          case 28:\n            _context.prev = 28;\n            setLoading(false);\n            return _context.finish(28);\n\n          case 31:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[8, 24, 28, 31]], Promise);\n  };\n\n  var FBlogIn = function FBlogIn() {\n    var _await$Facebook$logIn, type, token, response, _await$response$json, email, first_name, last_name, message;\n\n    return _regeneratorRuntime.async(function FBlogIn$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            setLoading(true);\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(Facebook.initializeAsync({\n              appId: '2733777443554055'\n            }));\n\n          case 4:\n            _context2.next = 6;\n            return _regeneratorRuntime.awrap(Facebook.logInWithReadPermissionsAsync({\n              permissions: ['public_profile', \"email\"]\n            }));\n\n          case 6:\n            _await$Facebook$logIn = _context2.sent;\n            type = _await$Facebook$logIn.type;\n            token = _await$Facebook$logIn.token;\n\n            if (!(type === 'success')) {\n              _context2.next = 23;\n              break;\n            }\n\n            _context2.next = 12;\n            return _regeneratorRuntime.awrap(fetch(\"https://graph.facebook.com/me?access_token=\" + token + \"&fields=id,last_name,first_name,email\"));\n\n          case 12:\n            response = _context2.sent;\n            _context2.next = 15;\n            return _regeneratorRuntime.awrap(response.json());\n\n          case 15:\n            _await$response$json = _context2.sent;\n            email = _await$response$json.email;\n            first_name = _await$response$json.first_name;\n            last_name = _await$response$json.last_name;\n            navigation.navigate(\"Signup\", {\n              email: email,\n              first_name: first_name,\n              last_name: last_name\n            });\n            setLoading(false);\n            _context2.next = 24;\n            break;\n\n          case 23:\n            setLoading(false);\n\n          case 24:\n            _context2.next = 30;\n            break;\n\n          case 26:\n            _context2.prev = 26;\n            _context2.t0 = _context2[\"catch\"](0);\n            message = _context2.t0.message;\n            alert(\"Facebook Login Error: \" + message);\n\n          case 30:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 26]], Promise);\n  };\n\n  var GGLogIn = function GGLogIn() {\n    var result, user, _await$user$json, email, family_name, given_name;\n\n    return _regeneratorRuntime.async(function GGLogIn$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            setLoading(true);\n            _context3.next = 4;\n            return _regeneratorRuntime.awrap(Google.logInAsync({\n              androidClientId: \"279164621755-lr72g7uhmf7mjeudc8noiuk9td7ddscl.apps.googleusercontent.com\",\n              iosClientId: \"279164621755-la27utrs44j9bmm53ro23r77dgm9cchk.apps.googleusercontent.com\",\n              scopes: ['profile', 'email']\n            }));\n\n          case 4:\n            result = _context3.sent;\n\n            if (!(result.type === 'success')) {\n              _context3.next = 18;\n              break;\n            }\n\n            _context3.next = 8;\n            return _regeneratorRuntime.awrap(fetch('https://www.googleapis.com/userinfo/v2/me', {\n              headers: {\n                Authorization: \"Bearer \" + result.accessToken\n              }\n            }));\n\n          case 8:\n            user = _context3.sent;\n            _context3.next = 11;\n            return _regeneratorRuntime.awrap(user.json());\n\n          case 11:\n            _await$user$json = _context3.sent;\n            email = _await$user$json.email;\n            family_name = _await$user$json.family_name;\n            given_name = _await$user$json.given_name;\n            navigation.navigate(\"Signup\", {\n              email: email,\n              family_name: family_name,\n              given_name: given_name\n            });\n            _context3.next = 19;\n            break;\n\n          case 18:\n            return _context3.abrupt(\"return\", {\n              cancelled: true\n            });\n\n          case 19:\n            _context3.next = 24;\n            break;\n\n          case 21:\n            _context3.prev = 21;\n            _context3.t0 = _context3[\"catch\"](0);\n            return _context3.abrupt(\"return\", {\n              error: true\n            });\n\n          case 24:\n            _context3.prev = 24;\n            setLoading(false);\n            return _context3.finish(24);\n\n          case 27:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[0, 21, 24, 27]], Promise);\n  };\n\n  return React.createElement(TouchableWithoutFeedback, {\n    onPress: Keyboard.dismiss,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }\n  }, React.createElement(AuthInput, _extends({}, emailInput, {\n    placeholder: \"\\uC774\\uBA54\\uC77C\",\n    keyboardType: \"email-address\",\n    returnKeyType: \"send\",\n    onSubmitEditing: handleLogin,\n    autoCorrect: false,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  })), React.createElement(AuthButton, {\n    loading: loading,\n    onPress: handleLogin,\n    text: \"\\uC774\\uBA54\\uC77C \\uD655\\uC778\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 17\n    }\n  }), React.createElement(FBContainer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 17\n    }\n  }, React.createElement(AuthButton, {\n    bgColor: \"#2D4DA7\",\n    loading: loading,\n    onPress: FBlogIn,\n    text: \"\\uD398\\uC774\\uC2A4\\uBD81\\uC73C\\uB85C \\uD68C\\uC6D0\\uAC00\\uC785\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 21\n    }\n  })), React.createElement(GGContainer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }\n  }, React.createElement(AuthButton, {\n    bgColor: \"#E34133\",\n    loading: loading,\n    onPress: GGLogIn,\n    text: \"\\uAD6C\\uAE00\\uB85C \\uD68C\\uC6D0\\uAC00\\uC785\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 21\n    }\n  }))));\n});","map":{"version":3,"sources":["C:/Users/GG/Documents/finalproject/semicolon-app/screens/auth/CheckEmail.js"],"names":["React","useState","styled","AuthButton","AuthInput","useInput","useMutation","LOG_IN","Facebook","Google","View","GGContainer","FBContainer","props","theme","lightGreyColor","navigation","emailInput","getParam","loading","setLoading","variables","email","value","requestSecretMutation","handleLogin","emailRegex","Alert","alert","test","requestSecret","data","console","log","navigate","FBlogIn","initializeAsync","appId","logInWithReadPermissionsAsync","permissions","type","token","fetch","response","json","first_name","last_name","message","GGLogIn","logInAsync","androidClientId","iosClientId","scopes","result","headers","Authorization","accessToken","user","family_name","given_name","cancelled","error","Keyboard","dismiss"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport styled from \"styled-components/native\";\r\nimport { TouchableWithoutFeedback, Keyboard } from \"react-native\";\r\nimport AuthButton from \"../../components/AuthButton\";\r\nimport AuthInput from \"../../components/AuthInput\";\r\nimport useInput from \"../../hooks/useInput\";\r\nimport { Alert } from \"react-native\";\r\nimport { useMutation } from 'react-apollo-hooks';\r\nimport { LOG_IN } from './AuthQueries';\r\nimport * as Facebook from 'expo-facebook';\r\nimport * as Google from 'expo-google-app-auth';\r\n\r\nconst View = styled.View`\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex: 1;\r\n`;\r\n\r\nconst GGContainer = styled.View`\r\nmargin-top: 20px;`\r\n\r\nconst FBContainer = styled.View`\r\n  margin-top: 25px;\r\n  padding-top: 25px;\r\n  border-top-width: 1px;\r\n  border-color: ${props => props.theme.lightGreyColor};\r\n  border-style: solid;\r\n`;\r\nexport default ({ navigation }) => {\r\n    const emailInput = useInput(navigation.getParam(\"email\", \"\"));\r\n    const [loading, setLoading] = useState(false);\r\n    const [requestSecretMutation] = useMutation(LOG_IN, {\r\n        variables: {\r\n            email: emailInput.value\r\n        }\r\n\r\n    });\r\n    const handleLogin = async () => {\r\n        const { value } = emailInput;\r\n        const emailRegex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n        if (value === \"\") {\r\n            return Alert.alert(\"ì´ë©”ì¼ì„ ìž…ë ¥í•´ ì£¼ì„¸ìš”!\");\r\n        } else if (!emailRegex.test(value)) {\r\n            return Alert.alert(\"ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹ˆì—ìš”!\");\r\n        }\r\n        try {\r\n\r\n            setLoading(true);\r\n            const { data: { requestSecret } } = await requestSecretMutation();\r\n            console.log(requestSecret);\r\n            if (requestSecret) {\r\n                Alert.alert(\"ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”\");\r\n                navigation.navigate(\"Confirm\", { email: value });\r\n                return;\r\n            } else {\r\n                Alert.alert(\"ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”\");\r\n            }\r\n\r\n        } catch (error) {\r\n            console.log(error);\r\n            Alert.alert(\"ë¡œê·¸ì¸ ì‹¤íŒ¨\", \"ì§€ê¸ˆì€ ë¡œê·¸ì¸í• ìˆ˜ ì—†ì–´ìš” ðŸ˜¥\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n\r\n    };\r\n    const FBlogIn = async () => {\r\n        try {\r\n            setLoading(true);\r\n            await Facebook.initializeAsync({\r\n                appId: '2733777443554055',\r\n            });\r\n            const {\r\n                type,\r\n                token\r\n            } = await Facebook.logInWithReadPermissionsAsync({\r\n                permissions: ['public_profile', \"email\"],\r\n            });\r\n            if (type === 'success') {\r\n                // Get the user's name using Facebook's Graph API\r\n                const response = await fetch(`https://graph.facebook.com/me?access_token=${token}&fields=id,last_name,first_name,email`);\r\n                const { email, first_name, last_name } = await response.json();\r\n                navigation.navigate(\"Signup\", { email, first_name, last_name });\r\n                setLoading(false);\r\n            } else {\r\n                setLoading(false);\r\n            }\r\n        } catch ({ message }) {\r\n            alert(`Facebook Login Error: ${message}`);\r\n        }\r\n    };\r\n    const GGLogIn = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const result = await Google.logInAsync({\r\n                androidClientId: \"279164621755-lr72g7uhmf7mjeudc8noiuk9td7ddscl.apps.googleusercontent.com\",\r\n                iosClientId: \"279164621755-la27utrs44j9bmm53ro23r77dgm9cchk.apps.googleusercontent.com\",\r\n                scopes: ['profile', 'email']\r\n            });\r\n            if (result.type === 'success') {\r\n                const user = await fetch('https://www.googleapis.com/userinfo/v2/me', {\r\n                    headers: { Authorization: `Bearer ${result.accessToken}` }\r\n                });\r\n                const { email, family_name, given_name } = await user.json();\r\n                navigation.navigate(\"Signup\", { email, family_name, given_name });\r\n            } else {\r\n                return { cancelled: true };\r\n            }\r\n        } catch (e) {\r\n            return { error: true };\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n    return (\r\n        <TouchableWithoutFeedback onPress={Keyboard.dismiss}>\r\n            <View>\r\n                <AuthInput\r\n                    {...emailInput}\r\n                    placeholder=\"ì´ë©”ì¼\"\r\n                    keyboardType=\"email-address\"\r\n                    returnKeyType=\"send\"\r\n                    onSubmitEditing={handleLogin}\r\n                    autoCorrect={false}\r\n                />\r\n                <AuthButton loading={loading} onPress={handleLogin} text=\"ì´ë©”ì¼ í™•ì¸\" />\r\n                <FBContainer>\r\n                    <AuthButton bgColor={\"#2D4DA7\"} loading={loading} onPress={FBlogIn} text=\"íŽ˜ì´ìŠ¤ë¶ìœ¼ë¡œ íšŒì›ê°€ìž…\" />\r\n                </FBContainer>\r\n                <GGContainer>\r\n                    <AuthButton bgColor={\"#E34133\"} loading={loading} onPress={GGLogIn} text=\"êµ¬ê¸€ë¡œ íšŒì›ê°€ìž…\" />\r\n                </GGContainer>\r\n            </View>\r\n        </TouchableWithoutFeedback>\r\n    );\r\n};"]},"metadata":{},"sourceType":"module"}